!function(){"use strict";function t(t,n){return{x:t||0,y:n||0}}const n=(t,n)=>(t.x=n.x,t.y=n.y,t),e=(t,n,e)=>(t.x=n,t.y=e,t),o=(t,n,e)=>(t.x=n.x+e.x,t.y=n.y+e.y,t),c=(t,n,e)=>(t.x=n.x-e.x,t.y=n.y-e.y,t),s=(t,n)=>t.x*n.x+t.y*n.y,r=(t,n,e)=>(t.x=n.x*e,t.y=n.y*e,t),i=(t,n)=>{const e=t.x-n.x,o=t.y-n.y;return Math.sqrt(e*e+o*o)},a=t=>{const n=t.x,e=t.y;return Math.sqrt(n*n+e*e)},u=(t,n)=>{const e=n.x,o=n.y;let c=e*e+o*o;return c>0&&(c=1/Math.sqrt(c),t.x=n.x*c,t.y=n.y*c),t},h=(t,n)=>{t.t.x+=t.o.x*n*n*.001,t.t.y+=t.o.y*n*n*.001,e(t.o,0,0)},f=t(),l=t(),p=t(),w=t(),d=t(),v=t(),M=t(),g=t(),y=t(),x=t(),b=t(),m=t(),k=t(),S=t(),A=(i,h,A,L,T,D,P,C,H,j,N,W,E,F,R)=>{e(f,0,0),e(l,0,0),e(p,0,0),e(w,0,0),e(d,0,0),e(v,0,0),e(M,0,0),e(g,0,0),e(y,0,0),e(x,0,0),e(b,0,0),e(m,0,0),e(k,0,0),e(S,0,0),!E||0===E.x&&0===E.y?(c(f,i,P),u(f,f)):e(f,E.x,E.y),r(l,f,-1);const $=A+H,G=1+(L>j?L:j);c(p,i,h);const I=s(f,p);r(w,f,I),c(d,p,w),c(v,P,C);const K=s(l,v);r(M,l,K),c(g,v,M),r(b,w,(A-H)/$),r(m,M,G*H/$),o(y,b,m),o(y,y,d),r(k,w,G*A/$),r(S,M,(H-A)/$),o(x,k,S),o(x,x,g);const O=o(t(),y,x),z=t();r(z,f,s(O,f));const U=c(t(),O,z);u(U,U);let Y=-s(O,U);Y/=1/(A+H);const Z=Math.abs(Y);if(Z>1e-4){const n=a(d),e=a(g),c=t(),s=t();r(c,U,Z<n*T?T:-n*D),r(s,U,Z<e*N?N:-e*W),o(y,y,c),o(x,x,s)}n(F,y),n(R,x)},L=t=>{const n=2*t.t.x-t.i.x,o=2*t.t.y-t.i.y;e(t.i,t.t.x,t.t.y),e(t.t,n,o)},T=t(),D=t();function P(t,n,e,o,s){c(T,n,t),c(D,o,e);const r=(-T.y*(t.x-e.x)+T.x*(t.y-e.y))/(-D.x*T.y+T.x*D.y),i=(D.x*(t.y-e.y)-D.y*(t.x-e.x))/(-D.x*T.y+T.x*D.y);return r>=0&&r<=1&&i>=0&&i<=1&&(s.x=t.x+i*T.x,s.y=t.y+i*T.y,!0)}const C=t(),H=t(),j=t(),N=t(),W=t(),E=t();const F=t(),R=t();function $(t,n,o,r){if(c(F,o,n),0===F.x&&0===F.y)throw new Error("ZeroLengthEdge");const a=((t.x-n.x)*F.x+(t.y-n.y)*F.y)/(F.x*F.x+F.y*F.y);r.u=a;const h=e(r.h,n.x+a*F.x,n.y+a*F.y);r.l=i(h,t);const f=((t,n,e)=>(t.y=e.x-n.x,t.x=n.y-e.y,u(t,t)))(r.p,n,o);c(R,t,h),r.v=s(f,R)}function G(t){return t&&"object"==typeof t&&"number"==typeof t.id}class I{constructor(t){this.M=t,this.g=I.hash(this.M),this.m=new Set}k(t){this.m.add(t)}S(t,n){const e=n.map(t=>t.A);this.M.every(t=>e.indexOf(t)>-1)&&!this.m.has(t)&&this.m.add(t)}L(t,n){const e=n.map(t=>t.A);this.M.every(t=>e.indexOf(t)>-1)&&this.m.has(t)&&this.m.delete(t)}static hash(t){return t.slice().sort().join("|")}}const K=33.3333333,O=new class{constructor(){this.T=1,this.m=new Map,this.D=new Map,this.P=new Set}C(t){const n={id:this.T++};return this.m.set(n,t),this.D.forEach(e=>e.S(n,t)),n}H(t){this.P.add(t)}j(t){return this.P.has(t)}N(){if(0===this.P.size)return;let t=!1;const n=e=>{e&&"object"==typeof e&&!G(e)&&Object.values(e).forEach(e=>{G(e)?(this.H(e),t=!0):n(e)})};this.P.forEach(t=>{if(this.P.delete(t),!this.m.has(t))return;const e=this.m.get(t);e.forEach(t=>{n(t)}),this.m.delete(t),this.D.forEach(n=>n.L(t,e))}),t&&this.N()}select(t){const n=I.hash(t);if(this.D.has(n))return this.D.get(n).m;const e=new I(t);return this.D.set(e.g,e),this.m.forEach((n,o)=>{let c=!0;for(let e=0;e<t.length;e++){const o=t[e];n.find(t=>t.A===o)||(c=!1)}c&&e.k(o)}),e.m}W(t){return this.select(t).values().next().value}data(t,n){const e=this.m.get(t);let o;for(let t=0;t<e.length;t++){const c=e[t];c.A===n&&(o=c)}return o}F(t){const n=this.W([t]);if(!n)return;return this.data(n,t)}};function z(){return O}function U(t,n,e){const o=e.getContext("2d"),c=window.devicePixelRatio||1;return e.style.width=t+"px",e.style.height=n+"px",e.width=Math.floor(t*c),e.height=Math.floor(n*c),o.scale(c,c),o.webkitImageSmoothingEnabled=!1,o.msImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,{width:t,height:n,R:e,$:o,G:c}}const Y=document.querySelector.bind(document),Z=Y("#r"),q=Y("#c"),B=Y("#u");if(!Z||!q||!B)throw new Error("Could not locate DOM!");function J(t,n,e,o){return t.addEventListener(n,e,o),()=>{t.removeEventListener(n,e,o)}}const Q="rgba(255,255,132,1)",V="rgba(255,255,132,0.5)",X="rgba(40,40,40,1)",_=56,tt="Arial, sans-serif";function nt(n=0,e=0){return t(n,e)}function et(t){const n=z().F("vp"),e=n.I;return t/n.K*e.width}function ot(t,n){const e=z().F("vp"),{O:o}=e;return et(t-("x"===n?o.target.x:o.target.y))}const ct=t=>t/z().F("vp").I.width*100;function st(){const t=z().F("vp"),{$:n}=t.I;n.save(),function(t){const{$:n}=t.I,{O:e}=t;n.scale(1,-1),n.translate(-et(e.U.x),-et(e.U.y))}(t),n.clearRect(0,0,t.I.R.width,t.I.R.height),n.restore()}function rt(t,n,e,c,s,r="transparent",i=tt){const a=z().F("vp"),{O:u}=a,h=nt();return h.x=u.target.x-u.U.x,h.y=u.target.y+u.U.y,o(h,h,n),it(t,h,e,c,s,r,i)}function it(t,n,e,o,c,s="transparent",r=tt){const i=z().F("vp"),{O:a}=i,{$:u}=i.I;u.save(),u.scale(1,-1);const{Y:h,font:f}=at(t,o,r);let l=0,p=et(-n.y+a.target.y);return u.font=f,t.split("\n").forEach((t,o)=>{const r=u.measureText(t).width+1,i=et(h);0===o&&(p+=i);const a="center"===e?ot(n.x,"x")-r/2:"left"===e?ot(n.x,"x"):ot(n.x,"x")-r;"transparent"!==s&&(u.fillStyle=s,u.fillRect(a,p,r,-i)),u.fillStyle=c,u.fillText(t,a,p),p+=i,l+=i}),u.restore(),ct(l)}function at(t,n,e=tt){const o=z().F("vp"),{$:c}=o.I,s=o.height/n;c.save();const r=`${s}px/1.2 ${e}`;c.font=r;const i=c.measureText(t),a=1.2*(i.actualBoundingBoxAscent?i.actualBoundingBoxAscent+i.actualBoundingBoxDescent:s);c.restore();const u=t.split("\n");return{font:r,total:ct(a*u.length),Z:1.2,Y:ct(a)}}function ut(){const t=window.innerWidth<window.innerHeight?window.innerWidth:.6*window.innerHeight,n=window.innerWidth<window.innerHeight?window.innerWidth/.6:window.innerHeight;return{A:"vp",ratio:.6,width:t,height:n,K:100,q:100/.6,I:U(t,n,q),O:{U:nt(50,50),mode:"center",target:nt(0,0)}}}function ht(){const t=ut(),n=z(),e=n.W(["vp"]);e&&n.H(e);Z.style.width=t.width+"px";const o=n=>Math.floor(n/t.K*t.I.width);t.I.$.translate(o(t.O.U.x),o(t.O.U.y)),t.I.$.scale(1,-1);const c=[t];n.C(c)}function ft(t,n,e,o){const c=n.x-e.x,s=n.y-e.y,r=Math.sin(o),i=Math.cos(o);return t.x=c*i-s*r+e.x,t.y=c*r+s*i+e.y,t}function lt(){return{l:0,v:0,u:0,h:t(),p:t()}}window.addEventListener("resize",ht);const pt=t(),wt=t(),dt=t();function vt(t,n,e){return c(pt,n.t,n.i),u(wt,pt),r(dt,wt,e),o(t,dt,n.t),t}function Mt(t){return Math.atan2(t.y,t.x)}function gt(t,n){const{width:e,height:c}=function(t){return{width:t.K,height:Math.min(.75*t.K,.75*t.q)}}(n),s=t.width/2,i=t.height/2,a=n.O.target,u=nt(Math.cos(t.B),Math.sin(t.B)),h=r(nt(),u,Math.min(e/2,c/2)),f=o(nt(),a,h),l=nt(f.x,f.y-s),p=nt(f.x,f.y+s);return ft(l,l,f,t.B),ft(p,p,f,t.B),{x:f.x,y:f.y,angle:t.B,J:s,V:i,X:l,p1:p}}function yt(t,e,s,i){h(t,i);const{X:a,p1:u,V:f}=gt(e,s),l={_:a,tt:u},p=t,w=f,d=lt();$(p.t,l._,l.tt,d);const v=n(nt(),d.h),M=c(nt(),e.nt.t,e.nt.i),g=c(nt(),v,M),y=2+w;if(d.u>=0&&d.u<=1&&d.l<=y){const t=1,n=1e7,e=.5,s=.87,i=.87,a=nt(),u=nt();A(p.t,p.i,t,e,s,i,v,g,n,e,s,i,d.p,a,u),c(p.i,p.t,a);const h=Math.abs(y-d.l);((t,...n)=>{for(let e=0;e<n.length;e++){const c=n[e];o(c,c,t)}})(r(nt(),d.p,d.v>0?h:-h),p.t,p.i)}L(t)}const xt=new URLSearchParams(window.location.search).get("seed"),bt=xt?Number(xt):Date.now(),mt=(St=61^(St=bt)^St>>>16,St+=St<<3,St=Math.imul(St,668265261),kt=(St^=St>>>15)>>>0,t=>(kt=kt+1831565813|0,(((t=(t=Math.imul(kt^kt>>>15,1|kt))+Math.imul(t^t>>>7,61|t)^t)^t>>>14)>>>0)/2**32));var kt,St;const At=()=>mt();let Lt;function Tt(){const t=z().F("vp"),{O:n}=t,e=2*n.U.x,o=2*n.U.y;if(!Lt){const n=document.createElement("canvas"),c=n.getContext("2d");Lt=U(et(2*t.O.U.x),et(2*t.O.U.y),n);const s=.1,r=.3,i=2*t.O.U.y*8;c.fillStyle=V;let a=0;for(;a<i;){const t=At()*e,n=At()*o,i=At()*(r-s)+s;c.beginPath(),c.arc(et(t),et(n),et(i),0,2*Math.PI,!1),c.fill(),a++}}const c=n.target.x/e,s=n.target.y/o,r=Math.floor(c),i=Math.floor(s);let a=n.target.x%e/e,u=n.target.y%o/o;a=n.target.x<0?1-Math.abs(a):a,u=n.target.y<0?1-Math.abs(u):u;const h=t.I.$;h.fillStyle=X,h.fillRect(ot(n.target.x-n.U.x,"x"),ot(n.target.y+n.U.y,"y"),et(2*n.U.x),et(2*-n.U.y)),h.drawImage(Lt.R,0,0,et(e),et(o),ot(r*e,"x"),ot(i*o,"y"),et(e),et(o)),a<.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot((r-1)*e,"x"),ot(i*o,"y"),et(e),et(o)),a>=.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot((r+1)*e,"x"),ot(i*o,"y"),et(e),et(o)),u<.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot(r*e,"x"),ot((i-1)*o,"y"),et(e),et(o)),u>=.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot(r*e,"x"),ot((i+1)*o,"y"),et(e),et(o)),a<.5&&u<.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot((r-1)*e,"x"),ot((i-1)*o,"y"),et(e),et(o)),a>=.5&&u<.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot((r+1)*e,"x"),ot((i-1)*o,"y"),et(e),et(o)),a<.5&&u>=.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot((r-1)*e,"x"),ot((i+1)*o,"y"),et(e),et(o)),a>=.5&&u>=.5&&h.drawImage(Lt.R,0,0,et(e),et(o),ot((r+1)*e,"x"),ot((i+1)*o,"y"),et(e),et(o))}function Dt(t,n,e){if(!e.et)return;const o=nt(),c=P(vt(nt(),t,n),t.i,e._,e.tt,o),s=lt();$(t.i,e._,e.tt,s),c&&s.v<0&&(e.et=!1)}function Pt(t,n,e){if(e.et)return;const s=nt(),i=P(vt(nt(),t,n),t.i,e._,e.tt,s),a=lt();if($(t.i,e._,e.tt,a),i&&a.v>0){h=t,f=n,l={t:e._,i:e._,o:nt()},p={t:e.tt,i:e.tt,o:nt()},c(j,h.t,h.i),u(N,j),r(W,N,f),o(E,W,h.t),P(E,h.i,l.t,p.t,C)&&(c(H,E,C),c(h.t,h.t,H),c(h.i,h.i,H));const i=1,w=1e7,d=1,v=0,M=0,g=nt(),y=nt();A(t.t,t.i,i,d,v,M,s,s,w,d,v,M,a.p,g,y),c(t.i,t.t,g)}var h,f,l,p}function Ct(t=nt(0,0)){const e=z().F("vp");return{B:0,width:e.K/2,height:e.K/16,nt:{o:nt(),t:n(nt(),t),i:n(nt(),t)}}}function Ht(t=nt(),e=0,o=nt()){const s=z().F("vp"),i={t:n(nt(),t),i:n(nt(),t),o:nt(),width:s.K/32,height:s.K/32},a=r(nt(),o,e);return c(i.i,i.t,a),i}function jt(t){return{nt:{t:n(nt(),t),i:n(nt(),t),o:nt()},ot:nt(10,10)}}function Nt(t,n){return{_:t,tt:n,et:!1}}const Wt={ct:0,st:null,state:"boot",level:-1,rt:null,it:[],at:[function(){return{ut:Ht(nt(),.1,nt(1,1)),ht:Ct(),target:jt(nt(-10,-10)),ft:[Nt(nt(50,50),nt(-50,50)),Nt(nt(-50,50),nt(-50,-50)),Nt(nt(-50,-50),nt(50,-50)),Nt(nt(50,-50),nt(50,50))],lt:[]}},function(){return{ut:Ht(nt(0,-10),.5,nt(0,1)),ht:Ct(),target:jt(nt(30,10)),ft:[Nt(nt(20,15),nt(-20,15)),(t=nt(-20,5),n=nt(20,5),{_:t,tt:n,et:!0}),Nt(nt(50,50),nt(-50,50)),Nt(nt(-50,50),nt(-50,-50)),Nt(nt(-50,-50),nt(50,-50)),Nt(nt(50,-50),nt(50,50))],lt:[]};var t,n},function(){const t=Ct();return{ut:Ht(nt(-30,-40),.5,nt(0,1)),ht:t,target:jt(nt(30,-40)),ft:[Nt(nt(50,50),nt(-50,50)),Nt(nt(-50,50),nt(-50,-50)),Nt(nt(-50,-50),nt(50,-50)),Nt(nt(50,-50),nt(50,50))],lt:[(e=nt(-20,10),o=nt(1,-1),{nt:{t:n(nt(),e),i:n(nt(),e),o:nt()},ot:nt(10,10),wt:n(nt(),o)})]};var e,o}]};function Et(t){const n=Wt;n.st=n.state,n.state=t,n.ct=0}function Ft(t){return t*K/1e3}function Rt(t){return t.toFixed(3)}const $t={KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,ArrowLeft:!1,ArrowRight:!1,ShiftLeft:!1,ShiftRight:!1};function Gt(){return $t}function It(t,n,e,o){const c=z().F("vp"),s=c.O.target,{U:r}=c.O,a=[[nt(s.x-r.x,s.y+r.y),nt(s.x+r.x,s.y+r.y),lt()],[nt(s.x+r.x,s.y+r.y),nt(s.x+r.x,s.y-r.y),lt()],[nt(s.x+r.x,s.y-r.y),nt(s.x-r.x,s.y-r.y),lt()],[nt(s.x-r.x,s.y-r.y),nt(s.x-r.x,s.y+r.y),lt()]];for(let n=0;n<a.length;n++){const[e,o,c]=a[n];$(t,e,o,c)}const[[u,h,f],[l,p,w],[d,v,M],[g,y,x]]=a;let b,m,k;const S=at(o,_);if(f.v>0&&w.v>0)b=nt(w.h.x,f.h.y),m=i(b,t),k="right";else if(w.v>0&&M.v>0)b=nt(w.h.x,M.h.y+S.Y),m=i(b,t),k="right";else if(M.v>0&&x.v>0)b=nt(x.h.x,M.h.y+S.Y),m=i(b,t),k="left";else if(x.v>0&&f.v>0)b=nt(x.h.x,f.h.y),m=i(b,t),k="left";else if(f.v>0)b=nt(Math.min(Math.max(f.h.x,u.x),h.x),f.h.y),m=f.l,k="center";else if(w.v>0)b=nt(w.h.x,Math.max(Math.min(l.y,w.h.y),p.y)),m=w.l,k="right";else if(M.v>0)b=nt(Math.max(Math.min(d.x,M.h.x),v.x),M.h.y+S.Y),m=M.l,k="center";else{if(!(x.v>0))return;b=nt(x.h.x,Math.min(Math.max(g.y,x.h.y),y.y)),m=x.l,k="left"}if(m<.7*((n.x/2+n.y/2)/2))return;const A=c.I.$;A.save(),it(o,b,k,_,X,Q),A.restore()}J(window,"keydown",t=>{$t[t.code]=!0}),J(window,"keyup",t=>{$t[t.code]=!1});function Kt(t,n){return!!((t,n,o,c,s,r,i,a,u)=>{const h=s-t,f=i/2+o/2-Math.abs(h),l=r-n,p=a/2+c/2-Math.abs(l);if(f<=0)return null;if(p<=0)return null;if(e(u.resolve,0,0),e(u.dt,0,0),e(u.vt,0,0),f<p){const n=h<0?-1:1;u.resolve.x=f*n,u.vt.x=n,u.dt.x=t+o/2*n,u.dt.y=r}else{const t=l<0?-1:1;u.resolve.y=p*t,u.vt.y=t,u.dt.x=s,u.dt.y=n+c/2*t}return u})(t.nt.t.x,t.nt.t.y,t.ot.x,t.ot.y,n.t.x,n.t.y,n.width,n.height,{resolve:nt(),dt:nt(),vt:nt()})}let Ot=0,zt=[];const Ut=z(),Yt=Ut.C([{A:"fps",Mt:60}]),Zt=t=>{rt(t.F("fps").Mt.toFixed(2),nt(100,0),"right",_,Q)};function qt(t){Ut.data(Yt,"fps").Mt=t}function Bt(t){const n=z().F("vp"),e=n.I.$,{x:o,y:c}=t.nt.t,s=t.ot.x/2,r=t.ot.x/4,i=n.K/64,a=t.ot.y/i,u=s*Math.SQRT2,h=i*Math.SQRT2/2;e.save(),e.fillStyle=Q,e.strokeStyle=Q;const f=Mt(t.wt);e.translate(ot(o,"x"),ot(c,"y")),e.rotate(f-Math.PI/2),Jt(e,a,i,u,0,0-r+h,Math.PI/4),Jt(e,a,i,u,0,0+r-h,-Math.PI/4),e.restore()}function Jt(t,n,e,o,c,s,r){for(let i=0;i<n;i+=2){t.save(),t.translate(et(s),et(c+i*e)),t.rotate(r);(i<Math.floor(n/4)?t.strokeRect:t.fillRect).call(t,et(0-o/2),et(0),et(o),et(e)),t.restore()}}function Qt(t,o){const c=o.nt.t,s=(o.ot.y,o.ot.x/2),r=nt(c.x,c.y+s),i=nt(c.x,c.y-s),a=Mt(o.wt);ft(r,r,c,a),ft(i,i,c,a);const u=nt(),h=P(t.i,t.t,r,i,u),f=lt();$(t.i,r,i,f),h&&f.v<0&&(n(t.t,o.nt.t),n(t.i,t.t),e(t.o,5*o.wt.x,5*o.wt.y))}function Vt(){}!async function(){await async function(){}();const t=z();ht();const e=[],s=[];e.push(t=>{st()});const i=t.F("vp");e.push((function(t,n){switch(Wt.state){case"boot":{Tt();let t=10;t-=it("SIGNAL DECAY",nt(0,t),"center",20,Q,"transparent","Courier, Courier New, monospace"),t-=5,it("a js13k entry by\nDrew Petersen",nt(0,t),"center",_,Q),t-=20,it("tap to start",nt(0,t),"center",_,Q);break}case"level":{if(!Wt.rt)break;const{target:t,ht:n,ut:e,ft:o,lt:s}=Wt.rt;Tt(),function(t,n){const e=z().F("vp").I.$,{x:o,y:c}=t.nt.t,s=t.ot.x/2,r=t.ot.y/2;e.save(),e.fillStyle=Q,e.translate(ot(o,"x"),ot(c,"y")),e.fillRect(0-et(s),0-et(r),et(t.ot.x),et(t.ot.y)),e.restore()}(t),function(t){const n=z().F("vp"),e=n.I.$,{x:o,y:c,angle:s,V:r,J:i,X:a,p1:u}=gt(t,n);e.save(),e.fillStyle=Q,e.translate(ot(o,"x"),ot(c,"y")),e.rotate(Math.PI/2+s),e.fillRect(0-et(i),0-et(r),et(t.width),et(t.height)),e.restore()}(n),function(t,n){const e=z().F("vp"),o=e.I.$,{t:s,i:i,width:h,height:f}=t,l=h/2,p=f/2,w=ot(i.x+1*(s.x-i.x),"x"),d=ot(i.y+1*(s.y-i.y),"y"),v=et(h),M=et(f);o.save();{const t=c(nt(),s,i),n=u(t,t),a=r(n,n,10*e.K);o.lineWidth=et(1),o.strokeStyle=V,o.setLineDash([et(1),et(3)]),o.beginPath(),o.moveTo(w,d),o.lineTo(w+et(a.x),d+et(a.y)),o.stroke(),o.setLineDash([])}{const t=l/8,n=c(nt(),s,i),e=a(n)/t,h=u(n,n);o.fillStyle="rgba(255,255,132,0.1)";const f=nt();for(let n=0;n<e;n++)r(f,h,n*t),o.fillRect(w-et(f.x)-et(l),d-et(f.y)-et(p),v,M)}o.fillStyle=Q,o.fillRect(w-et(l),d-et(p),v,M),o.restore()}(e),function(t){for(let n=0;n<t.length;n++)Bt(t[n])}(s),function(t){const{I:{$:n}}=z().F("vp");n.save(),n.strokeStyle=Q,n.lineWidth=et(1);for(let e=0;e<t.length;e++){const o=t[e];o.et?n.setLineDash([et(1),et(2)]):n.setLineDash([]),n.beginPath(),n.moveTo(ot(o._.x,"x"),ot(o._.y,"y")),n.lineTo(ot(o.tt.x,"x"),ot(o.tt.y,"y")),n.closePath(),n.stroke()}n.restore()}(o),function(t,n){const e=z().F("vp");rt(Rt(Ft(t.ct)),nt(e.K/2,0),"center",_,Q),rt(`Level ${t.level+1} of ??`,nt(0,0),"left",_,Q),t.rt&&(It(t.rt.target.nt.t,t.rt.target.ot,0,"TARGET"),It(t.rt.ut.t,nt(t.rt.ut.width,t.rt.ut.height),0,"SIGNAL"))}(Wt);break}case"win":{const n=t.F("vp");rt(`Mission\nCompleted!\n${Rt(Ft(Wt.it[Wt.level]))}s`,nt(n.K/2,-10),"center",15,Q);break}case"nextlevel":break;case"thanks":rt(`The SIGNAL\nmade it,\nthanks to you!\nTotal:\n${Rt(Ft(Wt.it.reduce((t,n)=>t+=n,0)))}s`,nt(t.F("vp").K/2,-10),"center",15,Q),console.log("thanks!");break}!function(t=X){const n=z().F("vp"),{$:e}=n.I;e.fillStyle=t;const o=2*n.O.U.x,c=n.q-2*n.O.U.y;e.fillRect(ot(n.O.target.x-n.O.U.x,"x"),ot(n.O.target.y-n.O.U.y,"y"),et(o),et(-c))}()})),s.push((t,e)=>{switch(Wt.state){case"boot":if(0===Wt.ct){const n=J(t.F("vp").I.R,"click",()=>{n(),Ot=0,zt.length=0,Et("nextlevel")})}break;case"level":{if(0===Wt.ct){const t=Wt.at[Wt.level];if(!t)return Et("thanks");Wt.rt=t()}if(!Wt.rt)break;const{target:t,ht:n,ut:e}=Wt.rt,c=Gt();c.ArrowLeft&&(n.B+=.1),c.ArrowRight&&function(t){t.B-=.1}(n);const s=c.ShiftLeft||c.ShiftRight?nt(1,0):nt(.2,0),r=nt();let i=0;if(c.KeyW&&c.KeyD?i=Math.PI/4:c.KeyW&&c.KeyA?i=Math.PI*(3/4):c.KeyS&&c.KeyD?i=-Math.PI/4:c.KeyS&&c.KeyA?i=-Math.PI*(3/4):c.KeyW?i=Math.PI/2:c.KeyA?i=Math.PI:c.KeyS?i=-Math.PI/2:c.KeyD&&(i=0),(0!==i||c.KeyD)&&function(t,n){o(t.nt.o,t.nt.o,n)}(n,ft(nt(),s,r,i)),Kt(t,e)){const t=Wt;return t.it[t.level]=t.ct,Et("win")}break}case"win":0===Wt.ct&&(c=()=>Et("nextlevel"),s=1e3,zt.push({id:++Ot,action:c,delay:s,gt:0}));break;case"nextlevel":{const t=Wt;return t.level+=1,t.rt=null,Et("level")}}var c,s;if(!Wt.rt)return;const{target:r,ht:a,ut:u,ft:f,lt:l}=Wt.rt;r&&a&&u&&(((t,n)=>{const e=(t.i.x-t.t.x)*n,o=(t.i.y-t.t.y)*n;t.i.x=t.t.x+e,t.i.y=t.t.y+o})(a.nt,.8),h(a.nt,e),yt(u,a,i,e),function(t,n){for(let e=0;e<n.length;e++)Qt(t,n[e])}(u,l),function(t,n){for(let e=0;e<t.length;e++){const o=t[e];Dt(n,n.width/2,o),Pt(n,n.width/2,o)}}(f,u),L(a.nt),function(t){const e=z().F("vp");n(e.O.target,t)}(a.nt.t)),Wt.ct+=1}),e.push(Zt);const{stop:f}=(({yt:t,xt:n,bt:e,update:o,kt:c=10,St:s=(()=>{}),At:r=(()=>{})})=>{const i=window.performance,a=t,u=n,h=i.now.bind(i),f=window.requestAnimationFrame.bind(window);let l=0,p=null,w=h(),d=h(),v=0,M=60;return function t(){const n=h();p=f(t),l+=n-w,w=n;let i=l-a>=0,g=Math.floor(l/u);if(g>=c)return l=0,w=h(),void s();for(;g-- >0;)l-=u,o(u);i&&e(l/a),v+=1,d+1e3<=n&&(M=.25*v+.75*M,v=0,d=n,r(M))}(),{stop:()=>{p&&cancelAnimationFrame(p)}}})({yt:16.6666666,xt:K,update:n=>{((t=1)=>{zt.slice().forEach((n,e)=>{n.gt+=t,n.gt>=n.delay&&(zt.splice(e,1),n.action(n.delay,n.gt))})})(n),s.forEach(e=>e(t,n)),t.N()},bt:n=>{e.forEach(e=>e(t,n))},St:Vt,At:qt})}()}();