!function(){"use strict";function t(t,n){return{x:t||0,y:n||0}}const n=(t,n)=>(t.x=n.x,t.y=n.y,t),e=(t,n,e)=>(t.x=n,t.y=e,t),o=(t,n,e)=>(t.x=n.x+e.x,t.y=n.y+e.y,t),c=(t,n,e)=>(t.x=n.x-e.x,t.y=n.y-e.y,t),s=(t,n)=>t.x*n.x+t.y*n.y,r=(t,n,e)=>(t.x=n.x*e,t.y=n.y*e,t),i=(t,n)=>{const e=t.x-n.x,o=t.y-n.y;return Math.sqrt(e*e+o*o)},a=t=>{const n=t.x,e=t.y;return Math.sqrt(n*n+e*e)},u=(t,n)=>{const e=n.x,o=n.y;let c=e*e+o*o;return c>0&&(c=1/Math.sqrt(c),t.x=n.x*c,t.y=n.y*c),t},h=(t,n)=>{t.t.x+=t.o.x*n*n*.001,t.t.y+=t.o.y*n*n*.001,e(t.o,0,0)},f=t(),l=t(),p=t(),d=t(),w=t(),v=t(),M=t(),g=t(),y=t(),b=t(),m=t(),x=t(),k=t(),S=t(),T=(i,h,T,A,L,C,O,R,P,D,H,N,I,E,F)=>{e(f,0,0),e(l,0,0),e(p,0,0),e(d,0,0),e(w,0,0),e(v,0,0),e(M,0,0),e(g,0,0),e(y,0,0),e(b,0,0),e(m,0,0),e(x,0,0),e(k,0,0),e(S,0,0),!I||0===I.x&&0===I.y?(c(f,i,O),u(f,f)):e(f,I.x,I.y),r(l,f,-1);const K=T+P,W=1+(A>D?A:D);c(p,i,h);const j=s(f,p);r(d,f,j),c(w,p,d),c(v,O,R);const G=s(l,v);r(M,l,G),c(g,v,M),r(m,d,(T-P)/K),r(x,M,W*P/K),o(y,m,x),o(y,y,w),r(k,d,W*T/K),r(S,M,(P-T)/K),o(b,k,S),o(b,b,g);const B=o(t(),y,b),$=t();r($,f,s(B,f));const z=c(t(),B,$);u(z,z);let U=-s(B,z);U/=1/(T+P);const Y=Math.abs(U);if(Y>1e-4){const n=a(w),e=a(g),c=t(),s=t();r(c,z,Y<n*L?L:-n*C),r(s,z,Y<e*H?H:-e*N),o(y,y,c),o(b,b,s)}n(E,y),n(F,b)},A=t=>{const n=2*t.t.x-t.i.x,o=2*t.t.y-t.i.y;e(t.i,t.t.x,t.t.y),e(t.t,n,o)},L=t(),C=t();function O(t,n,e,o,s){c(L,n,t),c(C,o,e);const r=(-L.y*(t.x-e.x)+L.x*(t.y-e.y))/(-C.x*L.y+L.x*C.y),i=(C.x*(t.y-e.y)-C.y*(t.x-e.x))/(-C.x*L.y+L.x*C.y);return r>=0&&r<=1&&i>=0&&i<=1&&(s.x=t.x+i*L.x,s.y=t.y+i*L.y,!0)}const R=t(),P=t(),D=t(),H=t(),N=t(),I=t();const E=t(),F=t();function K(t,n,o,r){if(c(E,o,n),0===E.x&&0===E.y)throw new Error("ZeroLengthEdge");const a=((t.x-n.x)*E.x+(t.y-n.y)*E.y)/(E.x*E.x+E.y*E.y);r.u=a;const h=e(r.h,n.x+a*E.x,n.y+a*E.y);r.l=i(h,t);const f=((t,n,e)=>(t.y=e.x-n.x,t.x=n.y-e.y,u(t,t)))(r.p,n,o);c(F,t,h),r.v=s(f,F)}function W(t){return t&&"object"==typeof t&&"number"==typeof t.id}class j{constructor(t){this.M=t,this.g=j.hash(this.M),this.m=new Set}k(t){this.m.add(t)}S(t,n){const e=n.map(t=>t.T);this.M.every(t=>e.indexOf(t)>-1)&&!this.m.has(t)&&this.m.add(t)}A(t,n){const e=n.map(t=>t.T);this.M.every(t=>e.indexOf(t)>-1)&&this.m.has(t)&&this.m.delete(t)}static hash(t){return t.slice().sort().join("|")}}const G=33.3333333,B=new class{constructor(){this.L=1,this.m=new Map,this.C=new Map,this.O=new Set}R(t){const n={id:this.L++};return this.m.set(n,t),this.C.forEach(e=>e.S(n,t)),n}P(t){this.O.add(t)}D(t){return this.O.has(t)}H(){if(0===this.O.size)return;let t=!1;const n=e=>{e&&"object"==typeof e&&!W(e)&&Object.values(e).forEach(e=>{W(e)?(this.P(e),t=!0):n(e)})};this.O.forEach(t=>{if(this.O.delete(t),!this.m.has(t))return;const e=this.m.get(t);e.forEach(t=>{n(t)}),this.m.delete(t),this.C.forEach(n=>n.A(t,e))}),t&&this.H()}select(t){const n=j.hash(t);if(this.C.has(n))return this.C.get(n).m;const e=new j(t);return this.C.set(e.g,e),this.m.forEach((n,o)=>{let c=!0;for(let e=0;e<t.length;e++){const o=t[e];n.find(t=>t.T===o)||(c=!1)}c&&e.k(o)}),e.m}N(t){return this.select(t).values().next().value}data(t,n){const e=this.m.get(t);let o;for(let t=0;t<e.length;t++){const c=e[t];c.T===n&&(o=c)}return o}I(t){const n=this.N([t]);if(!n)return;return this.data(n,t)}};function $(){return B}function z(t,n,e){const o=e.getContext("2d"),c=window.devicePixelRatio||1;return e.style.width=t+"px",e.style.height=n+"px",e.width=Math.floor(t*c),e.height=Math.floor(n*c),o.scale(c,c),o.webkitImageSmoothingEnabled=!1,o.msImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,{width:t,height:n,F:e,K:o,W:c}}const U=document.querySelector.bind(document),Y=(document.querySelectorAll.bind(document),U("#r")),q=U("#c"),Z=U("#u");if(!Y||!q||!Z)throw new Error("Could not locate DOM!");function J(t,n,e,o){return t.addEventListener(n,e,o),()=>{t.removeEventListener(n,e,o)}}const Q="transparent",V="rgba(255,255,132,1)",X="rgba(255,255,132,0.5)",_="rgba(40,40,40,1)",tt=56,nt="Arial, sans-serif",et="Courier, Courier New, monospace";function ot(n=0,e=0){return t(n,e)}function ct(t){const n=$().I("vp"),e=n.j;return t/n.G*e.width}function st(t,n){const e=$().I("vp"),{B:o}=e;return ct(t-("x"===n?o.target.x:o.target.y))}const rt=t=>t/$().I("vp").j.width*100;function it(){const t=$().I("vp"),{K:n}=t.j;n.save(),function(t){const{K:n}=t.j,{B:e}=t;n.scale(1,-1),n.translate(-ct(e.$.x),-ct(e.$.y))}(t),n.clearRect(0,0,t.j.F.width,t.j.F.height),n.restore()}function at(t,n,e,c,s,r="transparent",i=nt){const a=$().I("vp"),{B:u}=a,h=ot();return h.x=u.target.x-u.$.x,h.y=u.target.y+u.$.y,o(h,h,n),ut(t,h,e,c,s,r,i)}function ut(t,n,e,o,c,s="transparent",r=nt){const i=$().I("vp"),{B:a}=i,{K:u}=i.j;u.save(),u.scale(1,-1);const{U:h,font:f}=ht(t,o,r);let l=0,p=ct(-n.y+a.target.y);return u.font=f,t.split("\n").forEach((t,o)=>{const r=u.measureText(t).width+1,i=ct(h);0===o&&(p+=i);const a="center"===e?st(n.x,"x")-r/2:"left"===e?st(n.x,"x"):st(n.x,"x")-r;"transparent"!==s&&(u.fillStyle=s,u.fillRect(a,p,r,-i)),u.fillStyle=c,u.fillText(t,a,p),p+=i,l+=i}),u.restore(),rt(l)}function ht(t,n,e=nt){const o=$().I("vp"),{K:c}=o.j,s=o.height/n;c.save();const r=`${s}px/1.2 ${e}`;c.font=r;const i=c.measureText(t),a=1.2*(i.actualBoundingBoxAscent?i.actualBoundingBoxAscent+i.actualBoundingBoxDescent:s);c.restore();const u=t.split("\n");return{font:r,fontSize:s+"px",total:rt(a*u.length),Y:1.2,U:rt(a)}}function ft(){const t=window.innerWidth<window.innerHeight?window.innerWidth:.6*window.innerHeight,n=window.innerWidth<window.innerHeight?window.innerWidth/.6:window.innerHeight;return{T:"vp",ratio:.6,width:t,height:n,G:100,q:100/.6,j:z(t,n,q),B:{$:ot(50,50),mode:"center",target:ot(0,0)}}}function lt(){const t=ft(),n=$(),e=n.N(["vp"]);e&&n.P(e);Y.style.width=t.width+"px";const o=n=>Math.floor(n/t.G*t.j.width);t.j.K.translate(o(t.B.$.x),o(t.B.$.y)),t.j.K.scale(1,-1);const c=[t];n.R(c)}function pt(t,n,e,o){const c=n.x-e.x,s=n.y-e.y,r=Math.sin(o),i=Math.cos(o);return t.x=c*i-s*r+e.x,t.y=c*r+s*i+e.y,t}function dt(){return{l:0,v:0,u:0,h:t(),p:t()}}window.addEventListener("resize",lt);const wt=t(),vt=t(),Mt=t();function gt(t,n,e){return c(wt,n.t,n.i),u(vt,wt),r(Mt,vt,e),o(t,Mt,n.t),t}function yt(t){return Math.atan2(t.y,t.x)}const bt=new URLSearchParams(window.location.search);function mt(t,n){const{width:e,height:c}=function(t){return{width:t.G,height:Math.min(.75*t.G,.75*t.q)}}(n),s=t.width/2,i=t.height/2,a=n.B.target,u=ot(Math.cos(t.Z),Math.sin(t.Z)),h=r(ot(),u,Math.min(e/2,c/2)),f=o(ot(),a,h),l=ot(f.x,f.y-s),p=ot(f.x,f.y+s);return pt(l,l,f,t.Z),pt(p,p,f,t.Z),{x:f.x,y:f.y,angle:t.Z,J:s,V:i,X:l,p1:p}}function xt(t,e,s,i){h(t,i);const{X:a,p1:u,V:f}=mt(e,s),l={_:a,tt:u},p=t,d=f,w=dt();K(p.t,l._,l.tt,w);const v=n(ot(),w.h),M=c(ot(),e.nt.t,e.nt.i),g=c(ot(),v,M),y=2+d;if(w.u>=0&&w.u<=1&&w.l<=y){const t=1,n=1e7,e=.5,s=.87,i=.87,a=ot(),u=ot();T(p.t,p.i,t,e,s,i,v,g,n,e,s,i,w.p,a,u),c(p.i,p.t,a);const h=Math.abs(y-w.l);((t,...n)=>{for(let e=0;e<n.length;e++){const c=n[e];o(c,c,t)}})(r(ot(),w.p,w.v>0?h:-h),p.t,p.i)}A(t)}const kt=bt.get("seed"),St=kt?Number(kt):Date.now(),Tt=(Lt=61^(Lt=St)^Lt>>>16,Lt+=Lt<<3,Lt=Math.imul(Lt,668265261),At=(Lt^=Lt>>>15)>>>0,t=>(At=At+1831565813|0,(((t=(t=Math.imul(At^At>>>15,1|At))+Math.imul(t^t>>>7,61|t)^t)^t>>>14)>>>0)/2**32));var At,Lt;const Ct=()=>Tt();function Ot(){const t=$().I("vp"),{B:n,j:{K:e}}=t;e.fillStyle=_,e.fillRect(st(n.target.x-n.$.x,"x"),st(n.target.y+n.$.y,"y"),ct(2*n.$.x),ct(2*-n.$.y))}let Rt;function Pt(){const t=$().I("vp"),{B:n}=t,e=2*n.$.x,o=2*n.$.y;if(!Rt){const n=document.createElement("canvas"),c=n.getContext("2d");Rt=z(ct(2*t.B.$.x),ct(2*t.B.$.y),n);const s=.1,r=.3,i=2*t.B.$.y*8;c.fillStyle=X;let a=0;for(;a<i;){const t=Ct()*e,n=Ct()*o,i=Ct()*(r-s)+s;c.beginPath(),c.arc(ct(t),ct(n),ct(i),0,2*Math.PI,!1),c.fill(),a++}}const c=n.target.x/e,s=n.target.y/o,r=Math.floor(c),i=Math.floor(s);let a=n.target.x%e/e,u=n.target.y%o/o;a=n.target.x<0?1-Math.abs(a):a,u=n.target.y<0?1-Math.abs(u):u;const h=t.j.K;Ot(),h.drawImage(Rt.F,0,0,ct(e),ct(o),st(r*e,"x"),st(i*o,"y"),ct(e),ct(o)),a<.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st((r-1)*e,"x"),st(i*o,"y"),ct(e),ct(o)),a>=.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st((r+1)*e,"x"),st(i*o,"y"),ct(e),ct(o)),u<.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st(r*e,"x"),st((i-1)*o,"y"),ct(e),ct(o)),u>=.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st(r*e,"x"),st((i+1)*o,"y"),ct(e),ct(o)),a<.5&&u<.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st((r-1)*e,"x"),st((i-1)*o,"y"),ct(e),ct(o)),a>=.5&&u<.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st((r+1)*e,"x"),st((i-1)*o,"y"),ct(e),ct(o)),a<.5&&u>=.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st((r-1)*e,"x"),st((i+1)*o,"y"),ct(e),ct(o)),a>=.5&&u>=.5&&h.drawImage(Rt.F,0,0,ct(e),ct(o),st((r+1)*e,"x"),st((i+1)*o,"y"),ct(e),ct(o))}function Dt(t,n,e){if(!e.et)return;const o=ot(),c=O(gt(ot(),t,n),t.i,e._,e.tt,o),s=dt();K(t.i,e._,e.tt,s),c&&s.v<0&&(e.et=!1)}function Ht(t,n,e){if(e.et)return;const s=ot(),i=O(gt(ot(),t,n),t.i,e._,e.tt,s),a=dt();if(K(t.i,e._,e.tt,a),i&&a.v>0){h=t,f=n,l={t:e._,i:e._,o:ot()},p={t:e.tt,i:e.tt,o:ot()},c(D,h.t,h.i),u(H,D),r(N,H,f),o(I,N,h.t),O(I,h.i,l.t,p.t,R)&&(c(P,I,R),c(h.t,h.t,P),c(h.i,h.i,P));const i=1,d=1e7,w=1,v=0,M=0,g=ot(),y=ot();T(t.t,t.i,i,w,v,M,s,s,d,w,v,M,a.p,g,y),c(t.i,t.t,g)}var h,f,l,p}function Nt(t=ot(0,0)){const e=$().I("vp");return{Z:0,width:e.G/2,height:e.G/16,nt:{o:ot(),t:n(ot(),t),i:n(ot(),t)}}}function It(t=ot(),e=0,o=ot()){const s=$().I("vp"),i={t:n(ot(),t),i:n(ot(),t),o:ot(),width:s.G/32,height:s.G/32},a=r(ot(),o,e);return c(i.i,i.t,a),i}function Et(t){return{nt:{t:n(ot(),t),i:n(ot(),t),o:ot()},ot:ot(10,10)}}function Ft(t,n){return{_:t,tt:n,et:!1}}const Kt={ct:0,st:null,state:"boot",level:-1,rt:null,it:[],at:[function(){return{ut:It(ot(),.1,ot(1,1)),ht:Nt(),target:Et(ot(-10,-10)),ft:[Ft(ot(50,50),ot(-50,50)),Ft(ot(-50,50),ot(-50,-50)),Ft(ot(-50,-50),ot(50,-50)),Ft(ot(50,-50),ot(50,50))],lt:[]}},function(){return{ut:It(ot(0,-10),.5,ot(0,1)),ht:Nt(),target:Et(ot(30,10)),ft:[Ft(ot(20,15),ot(-20,15)),(t=ot(-20,5),n=ot(20,5),{_:t,tt:n,et:!0}),Ft(ot(50,50),ot(-50,50)),Ft(ot(-50,50),ot(-50,-50)),Ft(ot(-50,-50),ot(50,-50)),Ft(ot(50,-50),ot(50,50))],lt:[]};var t,n},function(){const t=Nt();return{ut:It(ot(-30,-40),.5,ot(0,1)),ht:t,target:Et(ot(30,-40)),ft:[Ft(ot(50,50),ot(-50,50)),Ft(ot(-50,50),ot(-50,-50)),Ft(ot(-50,-50),ot(50,-50)),Ft(ot(50,-50),ot(50,50))],lt:[(e=ot(-20,10),o=ot(1,-1),{nt:{t:n(ot(),e),i:n(ot(),e),o:ot()},ot:ot(10,10),dt:n(ot(),o)})]};var e,o}]};function Wt(t){const n=Kt;n.st=n.state,n.state=t,n.ct=0}function jt(t){return t*G/1e3}function Gt(t){return t.toFixed(3)}const Bt={KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,ArrowLeft:!1,ArrowRight:!1,ShiftLeft:!1,ShiftRight:!1};function $t(){return Bt}function zt(t,n,e,o){const c=$().I("vp"),s=c.B.target,{$:r}=c.B,a=[[ot(s.x-r.x,s.y+r.y),ot(s.x+r.x,s.y+r.y),dt()],[ot(s.x+r.x,s.y+r.y),ot(s.x+r.x,s.y-r.y),dt()],[ot(s.x+r.x,s.y-r.y),ot(s.x-r.x,s.y-r.y),dt()],[ot(s.x-r.x,s.y-r.y),ot(s.x-r.x,s.y+r.y),dt()]];for(let n=0;n<a.length;n++){const[e,o,c]=a[n];K(t,e,o,c)}const[[u,h,f],[l,p,d],[w,v,M],[g,y,b]]=a;let m,x,k;const S=ht(o,tt);if(f.v>0&&d.v>0)m=ot(d.h.x,f.h.y),x=i(m,t),k="right";else if(d.v>0&&M.v>0)m=ot(d.h.x,M.h.y+S.U),x=i(m,t),k="right";else if(M.v>0&&b.v>0)m=ot(b.h.x,M.h.y+S.U),x=i(m,t),k="left";else if(b.v>0&&f.v>0)m=ot(b.h.x,f.h.y),x=i(m,t),k="left";else if(f.v>0)m=ot(Math.min(Math.max(f.h.x,u.x),h.x),f.h.y),x=f.l,k="center";else if(d.v>0)m=ot(d.h.x,Math.max(Math.min(l.y,d.h.y),p.y)),x=d.l,k="right";else if(M.v>0)m=ot(Math.max(Math.min(w.x,M.h.x),v.x),M.h.y+S.U),x=M.l,k="center";else{if(!(b.v>0))return;m=ot(b.h.x,Math.min(Math.max(g.y,b.h.y),y.y)),x=b.l,k="left"}if(x<.7*((n.x/2+n.y/2)/2))return;const T=c.j.K;T.save(),ut(o,m,k,tt,_,V),T.restore()}J(window,"keydown",t=>{Bt[t.code]=!0}),J(window,"keyup",t=>{Bt[t.code]=!1});function Ut(t,n){return!!((t,n,o,c,s,r,i,a,u)=>{const h=s-t,f=i/2+o/2-Math.abs(h),l=r-n,p=a/2+c/2-Math.abs(l);if(f<=0)return null;if(p<=0)return null;if(e(u.resolve,0,0),e(u.wt,0,0),e(u.vt,0,0),f<p){const n=h<0?-1:1;u.resolve.x=f*n,u.vt.x=n,u.wt.x=t+o/2*n,u.wt.y=r}else{const t=l<0?-1:1;u.resolve.y=p*t,u.vt.y=t,u.wt.x=s,u.wt.y=n+c/2*t}return u})(t.nt.t.x,t.nt.t.y,t.ot.x,t.ot.y,n.t.x,n.t.y,n.width,n.height,{resolve:ot(),wt:ot(),vt:ot()})}let Yt=0,qt=[];const Zt=()=>{Yt=0,qt.length=0},Jt=$(),Qt=Jt.R([{T:"fps",Mt:60}]),Vt=t=>{if(!bt.has("debug"))return;at(t.I("fps").Mt.toFixed(2),ot(100,0),"right",tt,V)};function Xt(t){Jt.data(Qt,"fps").Mt=t}function _t(t){const n=$().I("vp"),e=n.j.K,{x:o,y:c}=t.nt.t,s=t.ot.x/2,r=t.ot.x/4,i=n.G/64,a=t.ot.y/i,u=s*Math.SQRT2,h=i*Math.SQRT2/2;e.save(),e.fillStyle=V,e.strokeStyle=V;const f=yt(t.dt);e.translate(st(o,"x"),st(c,"y")),e.rotate(f-Math.PI/2),tn(e,a,i,u,0,0-r+h,Math.PI/4),tn(e,a,i,u,0,0+r-h,-Math.PI/4),e.restore()}function tn(t,n,e,o,c,s,r){for(let i=0;i<n;i+=2){t.save(),t.translate(ct(s),ct(c+i*e)),t.rotate(r);(i<Math.floor(n/4)?t.strokeRect:t.fillRect).call(t,ct(0-o/2),ct(0),ct(o),ct(e)),t.restore()}}function nn(t,o){const c=o.nt.t,s=(o.ot.y,o.ot.x/2),r=ot(c.x,c.y+s),i=ot(c.x,c.y-s),a=yt(o.dt);pt(r,r,c,a),pt(i,i,c,a);const u=ot(),h=O(t.i,t.t,r,i,u),f=dt();K(t.i,r,i,f),h&&f.v<0&&(n(t.t,o.nt.t),n(t.i,t.t),e(t.o,5*o.dt.x,5*o.dt.y))}function en(t,n){U(":root").style.setProperty(t,n)}const on={gt:()=>{},yt:()=>{}},cn={bt:!1,move:t(),rotate:ot()};function sn(){const t=U("#btn-boost"),n=U("#btn-reset"),e=U("#stick-move"),o=U("#stick-move .ui-nub"),c=U("#stick-rotate"),s=U("#stick-rotate .ui-nub"),r=rn(e,o,cn.move),i=rn(c,s,cn.rotate),a=function(t,n){const e=J(t,"mouseup",t=>{t.preventDefault(),n()}),o=J(t,"touchstart",t=>{t.preventDefault()}),c=J(t,"touchend",t=>{n()});return()=>{e(),o(),c()}}(n,()=>{on.gt()}),u=J(t,"mousedown",()=>{cn.bt=!0}),h=J(t,"mouseup",()=>{cn.bt=!1}),f=J(t,"touchstart",()=>{cn.bt=!0}),l=J(t,"touchend",()=>{cn.bt=!1});on.yt=()=>{u(),h(),f(),l(),a(),r(),i()}}function rn(n,e,o){const c=t(),s=t(),r=J(n,"touchstart",t=>{t.preventDefault();const e=t.targetTouches[0];c.x=e.screenX,c.y=e.screenY;const o=n.getBoundingClientRect();s.x=o.width,s.y=o.height}),i=J(n,"touchmove",t=>{t.preventDefault();const n=t.targetTouches[0],r=n.screenX-c.x,i=-1*(n.screenY-c.y);o.x=r/(s.x/2),o.y=i/(s.y/2),u(o,e)}),a=J(n,"touchend",t=>{t.preventDefault(),c.x=c.y=0,s.x=s.y=0,o.x=o.y=0,u(o,e)});function u(t,n){const e=(t.x+1)/2*100,o=-(t.y-1)/2*100,c=Math.max(Math.min(e,100),0),s=Math.max(Math.min(o,100),0);n.style.setProperty("--leftPct",c+"%"),n.style.setProperty("--topPct",s+"%")}return()=>{r(),i(),a()}}function an(){}!async function(){await async function(){}();const t=$();lt(),function(){const t=ct($().I("vp").B.$.y),n=2*t,{fontSize:e}=ht("M",tt,nt);en("--yellowRGBA",V),en("--blackRGBA",_),en("--bodyFontSize",e),en("--ctrlPanelHeight",t+"px"),en("--ctrlPanelTop",n+"px")}();const s=[],i=[];s.push(t=>{it()});const f=t.I("vp");s.push((function(t,n){switch(Kt.state){case"boot":{Pt();let t=10;t-=ut("SIGNAL DECAY",ot(0,t),"center",20,V,Q,et),t-=5,ut("a js13k entry by\nDrew Petersen",ot(0,t),"center",tt,V),t-=20,ut("TAP OR CLICK TO START",ot(0,t),"center",tt,V,Q,et);break}case"tutorial":{Ot();let t=50;const n=-45;t-=5,t-=ut(["Be the best signalmancer in the galaxy!","","Help messages from deep space colonies bounce their","way to their targets as quickly as possible."].join("\n"),ot(n,t),"left",tt,V),t-=5,t-=ut("CONTROLS (KEYBOARD)",ot(n,t),"left",tt,V,Q,et),t-=5,t-=ut(["WASD:  move","Hold any SHIFT to boost","","Arrow Left / Arrow Right: rotate the Deflector"].join("\n"),ot(n,t),"left",tt,V),t-=5,t-=ut("CONTROLS (TOUCH)",ot(n,t),"left",tt,V,Q,et),t-=5,t-=ut(["Left Stick:  move","Move stick and hold BOOST to boost","","Right Stick: rotate the Deflector"].join("\n"),ot(n,t),"left",tt,V),t-=5,t-=ut("TAP OR CLICK TO CONTINUE",ot(0,t),"center",tt,V,Q,et);break}case"level":{if(!Kt.rt)break;const{target:t,ht:n,ut:e,ft:o,lt:s}=Kt.rt;Pt(),function(t,n){const e=$().I("vp").j.K,{x:o,y:c}=t.nt.t,s=t.ot.x/2,r=t.ot.y/2;e.save(),e.fillStyle=V,e.translate(st(o,"x"),st(c,"y")),e.fillRect(0-ct(s),0-ct(r),ct(t.ot.x),ct(t.ot.y)),e.restore()}(t),function(t){const n=$().I("vp"),e=n.j.K,{x:o,y:c,angle:s,V:r,J:i,X:a,p1:u}=mt(t,n);e.save(),e.fillStyle=V,e.translate(st(o,"x"),st(c,"y")),e.rotate(Math.PI/2+s),e.fillRect(0-ct(i),0-ct(r),ct(t.width),ct(t.height)),e.restore()}(n),function(t,n){const e=$().I("vp"),o=e.j.K,{t:s,i:i,width:h,height:f}=t,l=h/2,p=f/2,d=st(i.x+1*(s.x-i.x),"x"),w=st(i.y+1*(s.y-i.y),"y"),v=ct(h),M=ct(f);o.save();{const t=c(ot(),s,i),n=u(t,t),a=r(n,n,10*e.G);o.lineWidth=ct(1),o.strokeStyle=X,o.setLineDash([ct(1),ct(3)]),o.beginPath(),o.moveTo(d,w),o.lineTo(d+ct(a.x),w+ct(a.y)),o.stroke(),o.setLineDash([])}{const t=l/8,n=c(ot(),s,i),e=a(n)/t,h=u(n,n);o.fillStyle="rgba(255,255,132,0.1)";const f=ot();for(let n=0;n<e;n++)r(f,h,n*t),o.fillRect(d-ct(f.x)-ct(l),w-ct(f.y)-ct(p),v,M)}o.fillStyle=V,o.fillRect(d-ct(l),w-ct(p),v,M),o.restore()}(e),function(t){for(let n=0;n<t.length;n++)_t(t[n])}(s),function(t){const{j:{K:n}}=$().I("vp");n.save(),n.strokeStyle=V,n.lineWidth=ct(1);for(let e=0;e<t.length;e++){const o=t[e];o.et?n.setLineDash([ct(1),ct(2)]):n.setLineDash([]),n.beginPath(),n.moveTo(st(o._.x,"x"),st(o._.y,"y")),n.lineTo(st(o.tt.x,"x"),st(o.tt.y,"y")),n.closePath(),n.stroke()}n.restore()}(o),function(t,n){const e=$().I("vp");at(Gt(jt(t.ct)),ot(e.G/2,0),"center",tt,V),at(`Level ${t.level+1} of ??`,ot(0,0),"left",tt,V),t.rt&&(zt(t.rt.target.nt.t,t.rt.target.ot,0,"TARGET"),zt(t.rt.ut.t,ot(t.rt.ut.width,t.rt.ut.height),0,"SIGNAL"))}(Kt);break}case"win":{Ot();const n=t.I("vp");at(`Mission\nCompleted!\n${Gt(jt(Kt.it[Kt.level]))}s`,ot(n.G/2,-10),"center",15,V);break}case"nextlevel":break;case"thanks":Ot();at(`The SIGNAL\nmade it,\nthanks to you!\nTotal:\n${Gt(jt(Kt.it.reduce((t,n)=>t+=n,0)))}s`,ot(t.I("vp").G/2,-10),"center",15,V),console.log("thanks!");break}!function(t=_){const n=$().I("vp"),{K:e}=n.j;e.fillStyle=t;const o=2*n.B.$.x,c=n.q-2*n.B.$.y;e.fillRect(st(n.B.target.x-n.B.$.x,"x"),st(n.B.target.y-n.B.$.y,"y"),ct(o),ct(-c))}()})),i.push((t,c)=>{switch(Kt.state){case"boot":if(0===Kt.ct){const n=J(t.I("vp").j.F,"click",()=>{n(),Zt(),Wt("tutorial")})}break;case"tutorial":if(0===Kt.ct){const n=J(t.I("vp").j.F,"click",()=>{n(),Zt(),Wt("nextlevel")})}break;case"level":{if(0===Kt.ct){const t=Kt.at[Kt.level];if(!t)return Wt("thanks");Kt.rt=t(),sn(),i=()=>{Kt.rt=t()},on.gt=i}if(!Kt.rt)break;const{target:t,ht:n,ut:c}=Kt.rt,s=cn,r=$t();r.ArrowLeft&&(n.Z+=.1),r.ArrowRight&&function(t){t.Z-=.1}(n);const a=0!==s.rotate.x&&0!==s.rotate.y,u=yt(s.rotate);a&&function(t,n){t.Z=n}(n,u);const h=ot();let f=0;r.KeyW&&r.KeyD?f=Math.PI/4:r.KeyW&&r.KeyA?f=Math.PI*(3/4):r.KeyS&&r.KeyD?f=-Math.PI/4:r.KeyS&&r.KeyA?f=-Math.PI*(3/4):r.KeyW?f=Math.PI/2:r.KeyA?f=Math.PI:r.KeyS?f=-Math.PI/2:r.KeyD&&(f=0);const l=0!==s.move.x&&0!==s.move.y,p=yt(s.move),d=r.ShiftLeft||r.ShiftRight||s.bt?ot(1,0):ot(.2,0);l&&(f=p);const w=pt(ot(),d,h,f);l&&e(w,w.x*Math.abs(s.move.x),w.y*Math.abs(s.move.y));if((0!==f||0===f&&r.KeyD||l)&&function(t,n){o(t.nt.o,t.nt.o,n)}(n,w),Ut(t,c)){const t=Kt;return t.it[t.level]=t.ct,Wt("win")}break}case"win":0===Kt.ct&&(s=()=>Wt("nextlevel"),r=1e3,qt.push({id:++Yt,action:s,delay:r,xt:0}));break;case"nextlevel":{const t=Kt;return t.level+=1,t.rt=null,Wt("level")}}var s,r,i;if(!Kt.rt)return;const{target:a,ht:u,ut:l,ft:p,lt:d}=Kt.rt;a&&u&&l&&(((t,n)=>{const e=(t.i.x-t.t.x)*n,o=(t.i.y-t.t.y)*n;t.i.x=t.t.x+e,t.i.y=t.t.y+o})(u.nt,.8),h(u.nt,c),xt(l,u,f,c),function(t,n){for(let e=0;e<n.length;e++)nn(t,n[e])}(l,d),function(t,n){for(let e=0;e<t.length;e++){const o=t[e];Dt(n,n.width/2,o),Ht(n,n.width/2,o)}}(p,l),A(u.nt),function(t){const e=$().I("vp");n(e.B.target,t)}(u.nt.t)),Kt.ct+=1}),s.push(Vt);const{stop:l}=(({kt:t,St:n,Tt:e,update:o,At:c=10,Lt:s=(()=>{}),Ct:r=(()=>{})})=>{const i=window.performance,a=t,u=n,h=i.now.bind(i),f=window.requestAnimationFrame.bind(window);let l=0,p=null,d=h(),w=h(),v=0,M=60;return function t(){const n=h();p=f(t),l+=n-d,d=n;let i=l-a>=0,g=Math.floor(l/u);if(g>=c)return l=0,d=h(),void s();for(;g-- >0;)l-=u,o(u);i&&e(l/a),v+=1,w+1e3<=n&&(M=.25*v+.75*M,v=0,w=n,r(M))}(),{stop:()=>{p&&cancelAnimationFrame(p)}}})({kt:16.6666666,St:G,update:n=>{((t=1)=>{qt.slice().forEach((n,e)=>{n.xt+=t,n.xt>=n.delay&&(qt.splice(e,1),n.action(n.delay,n.xt))})})(n),i.forEach(e=>e(t,n)),t.H()},Tt:n=>{s.forEach(e=>e(t,n))},Lt:an,Ct:Xt})}()}();