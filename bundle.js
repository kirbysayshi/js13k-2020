!function(){"use strict";function t(t,n){return{x:t||0,y:n||0}}const n=(t,n)=>(t.x=n.x,t.y=n.y,t),e=(t,n,e)=>(t.x=n,t.y=e,t),o=(t,n,e)=>(t.x=n.x+e.x,t.y=n.y+e.y,t),c=(t,n,e)=>(t.x=n.x-e.x,t.y=n.y-e.y,t),s=(t,n)=>t.x*n.x+t.y*n.y,i=(t,n,e)=>(t.x=n.x*e,t.y=n.y*e,t),r=(t,n)=>{const e=t.x-n.x,o=t.y-n.y;return Math.sqrt(e*e+o*o)},a=t=>{const n=t.x,e=t.y;return Math.sqrt(n*n+e*e)},u=(t,n)=>{const e=n.x,o=n.y;let c=e*e+o*o;return c>0&&(c=1/Math.sqrt(c),t.x=n.x*c,t.y=n.y*c),t},h=(t,n)=>{t.t.x+=t.o.x*n*n*.001,t.t.y+=t.o.y*n*n*.001,e(t.o,0,0)},f=t(),l=t(),p=t(),d=t(),w=t(),M=t(),v=t(),g=t(),x=t(),y=t(),b=t(),m=t(),k=t(),S=t(),L=(r,h,L,A,T,H,P,D,W,j,F,R,C,E,K)=>{e(f,0,0),e(l,0,0),e(p,0,0),e(d,0,0),e(w,0,0),e(M,0,0),e(v,0,0),e(g,0,0),e(x,0,0),e(y,0,0),e(b,0,0),e(m,0,0),e(k,0,0),e(S,0,0),!C||0===C.x&&0===C.y?(c(f,r,P),u(f,f)):e(f,C.x,C.y),i(l,f,-1);const N=L+W,G=1+(A>j?A:j);c(p,r,h);const I=s(f,p);i(d,f,I),c(w,p,d),c(M,P,D);const O=s(l,M);i(v,l,O),c(g,M,v),i(b,d,(L-W)/N),i(m,v,G*W/N),o(x,b,m),o(x,x,w),i(k,d,G*L/N),i(S,v,(W-L)/N),o(y,k,S),o(y,y,g);const $=o(t(),x,y),z=t();i(z,f,s($,f));const U=c(t(),$,z);u(U,U);let Z=-s($,U);Z/=1/(L+W);const q=Math.abs(Z);if(q>1e-4){const n=a(w),e=a(g),c=t(),s=t();i(c,U,q<n*T?T:-n*H),i(s,U,q<e*F?F:-e*R),o(x,x,c),o(y,y,s)}n(E,x),n(K,y)},A=t=>{const n=2*t.t.x-t.i.x,o=2*t.t.y-t.i.y;e(t.i,t.t.x,t.t.y),e(t.t,n,o)},T=t(),H=t();function P(t,n,e,o,s){c(T,n,t),c(H,o,e);const i=(-T.y*(t.x-e.x)+T.x*(t.y-e.y))/(-H.x*T.y+T.x*H.y),r=(H.x*(t.y-e.y)-H.y*(t.x-e.x))/(-H.x*T.y+T.x*H.y);return i>=0&&i<=1&&r>=0&&r<=1&&(s.x=t.x+r*T.x,s.y=t.y+r*T.y,!0)}const D=t(),W=t(),j=t(),F=t(),R=t(),C=t();const E=t(),K=t();function N(t,n,o,i){if(c(E,o,n),0===E.x&&0===E.y)throw new Error("ZeroLengthEdge");const a=((t.x-n.x)*E.x+(t.y-n.y)*E.y)/(E.x*E.x+E.y*E.y);i.u=a;const h=e(i.h,n.x+a*E.x,n.y+a*E.y);i.l=r(h,t);const f=((t,n,e)=>(t.y=e.x-n.x,t.x=n.y-e.y,u(t,t)))(i.p,n,o);c(K,t,h),i.M=s(f,K)}function G(t){return t&&"object"==typeof t&&"number"==typeof t.id}class I{constructor(t){this.v=t,this.g=I.hash(this.v),this.m=new Set}k(t){this.m.add(t)}S(t,n){const e=n.map(t=>t.L);this.v.every(t=>e.indexOf(t)>-1)&&!this.m.has(t)&&this.m.add(t)}A(t,n){const e=n.map(t=>t.L);this.v.every(t=>e.indexOf(t)>-1)&&this.m.has(t)&&this.m.delete(t)}static hash(t){return t.slice().sort().join("|")}}const O=33.3333333,$=new class{constructor(){this.T=1,this.m=new Map,this.H=new Map,this.P=new Set}D(t){const n={id:this.T++};return this.m.set(n,t),this.H.forEach(e=>e.S(n,t)),n}W(t){this.P.add(t)}j(t){return this.P.has(t)}F(){if(0===this.P.size)return;let t=!1;const n=e=>{e&&"object"==typeof e&&!G(e)&&Object.values(e).forEach(e=>{G(e)?(this.W(e),t=!0):n(e)})};this.P.forEach(t=>{if(this.P.delete(t),!this.m.has(t))return;const e=this.m.get(t);e.forEach(t=>{n(t)}),this.m.delete(t),this.H.forEach(n=>n.A(t,e))}),t&&this.F()}select(t){const n=I.hash(t);if(this.H.has(n))return this.H.get(n).m;const e=new I(t);return this.H.set(e.g,e),this.m.forEach((n,o)=>{let c=!0;for(let e=0;e<t.length;e++){const o=t[e];n.find(t=>t.L===o)||(c=!1)}c&&e.k(o)}),e.m}R(t){return this.select(t).values().next().value}data(t,n){const e=this.m.get(t);let o;for(let t=0;t<e.length;t++){const c=e[t];c.L===n&&(o=c)}return o}C(t){const n=this.R([t]);if(!n)return;return this.data(n,t)}};function z(){return $}function U(t,n,e){const o=e.getContext("2d"),c=window.devicePixelRatio||1;return e.style.width=t+"px",e.style.height=n+"px",e.width=Math.round(t*c),e.height=Math.round(n*c),o.scale(c,c),o.webkitImageSmoothingEnabled=!1,o.msImageSmoothingEnabled=!1,o.mozImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1,{width:t,height:n,K:e,N:o,G:c}}const Z=document.querySelector.bind(document),q=Z("#r"),B=Z("#c"),J=Z("#u");if(!q||!B||!J)throw new Error("Could not locate DOM!");function Q(t,n,e,o){return t.addEventListener(n,e,o),()=>{t.removeEventListener(n,e,o)}}const V="rgba(255,255,132,1)",X="rgba(255,255,132,0.5)",Y="rgba(40,40,40,1)";function _(n=0,e=0){return t(n,e)}function tt(t){const n=z().C("vp"),e=n.I;return t/n.O*e.width}function nt(t,n){const e=z().C("vp"),{$:o}=e;return tt(t-("x"===n?o.target.x:o.target.y))}const et=t=>t/z().C("vp").I.width*100;function ot(){const t=z().C("vp"),{N:n}=t.I;n.save(),function(t){const{N:n}=t.I,{$:e}=t;n.scale(1,-1),n.translate(-tt(e.U.x),-tt(e.U.y))}(t),n.clearRect(0,0,t.I.K.width,t.I.K.height),n.restore()}function ct(t,n,e,c,s){const i=z().C("vp"),{$:r}=i,a=_();return a.x=r.target.x-r.U.x,a.y=r.target.y+r.U.y,o(a,a,n),st(t,a,e,c,s)}function st(t,n,e,o,c,s="transparent"){const i=z().C("vp"),{$:r}=i,{N:a}=i.I;a.save(),a.scale(1,-1);const{Z:u,font:h}=it(t,o);let f=0,l=tt(-n.y+r.target.y);return a.font=h,t.split("\n").forEach((t,o)=>{const i=a.measureText(t).width+1,r=tt(u);0===o&&(l+=r);const h="center"===e?nt(n.x,"x")-i/2:"left"===e?nt(n.x,"x"):nt(n.x,"x")-i;"transparent"!==s&&(a.fillStyle=s,a.fillRect(h,l,i,-r)),a.fillStyle=c,a.fillText(t,h,l),l+=r,f+=r}),a.restore(),et(f)}function it(t,n){const e=z().C("vp"),{N:o}=e.I,c=e.height/n;o.save();const s=c+"px/1.2 Arial, sans-serif";o.font=s;const i=o.measureText(t),r=1.2*(i.actualBoundingBoxAscent?i.actualBoundingBoxAscent+i.actualBoundingBoxDescent:c);o.restore();const a=t.split("\n");return{font:s,total:et(r*a.length),q:1.2,Z:et(r)}}function rt(){const t=window.innerWidth<window.innerHeight?window.innerWidth:.6*window.innerHeight,n=window.innerWidth<window.innerHeight?window.innerWidth/.6:window.innerHeight;return{L:"vp",ratio:.6,width:t,height:n,O:100,B:100/.6,I:U(t,n,B),$:{U:_(50,50),mode:"center",target:_(0,0)}}}function at(){const t=rt(),n=z(),e=n.R(["vp"]);e&&n.W(e);q.style.width=t.width+"px";const o=n=>Math.floor(n/t.O*t.I.K.width);t.I.N.translate(o(t.$.U.x),o(t.$.U.y)),t.I.N.scale(1,-1);const c=[t];n.D(c)}function ut(t,n,e,o){const c=n.x-e.x,s=n.y-e.y,i=Math.sin(o),r=Math.cos(o);return t.x=c*r-s*i+e.x,t.y=c*i+s*r+e.y,t}function ht(){return{l:0,M:0,u:0,h:t(),p:t()}}window.addEventListener("resize",at);const ft=t(),lt=t(),pt=t();function dt(t,n,e){return c(ft,n.t,n.i),u(lt,ft),i(pt,lt,e),o(t,pt,n.t),t}function wt(t){return Math.atan2(t.y,t.x)}function Mt(t,n){const{width:e,height:c}=function(t){return{width:t.O,height:Math.min(.75*t.O,.75*t.B)}}(n),s=t.width/2,r=t.height/2,a=n.$.target,u=_(Math.cos(t.J),Math.sin(t.J)),h=i(_(),u,Math.min(e/2,c/2)),f=o(_(),a,h),l=_(f.x,f.y-s),p=_(f.x,f.y+s);return ut(l,l,f,t.J),ut(p,p,f,t.J),{x:f.x,y:f.y,angle:t.J,V:s,X:r,Y:l,p1:p}}function vt(t,e,s,r){h(t,r);const{Y:a,p1:u,X:f}=Mt(e,s),l={_:a,tt:u},p=t,d=f,w=ht();N(p.t,l._,l.tt,w);const M=n(_(),w.h),v=c(_(),e.nt.t,e.nt.i),g=c(_(),M,v),x=2+d;if(w.u>=0&&w.u<=1&&w.l<=x){const t=1,n=1e7,e=.5,s=.87,r=.87,a=_(),u=_();L(p.t,p.i,t,e,s,r,M,g,n,e,s,r,w.p,a,u),c(p.i,p.t,a);const h=Math.abs(x-w.l);((t,...n)=>{for(let e=0;e<n.length;e++){const c=n[e];o(c,c,t)}})(i(_(),w.p,w.M>0?h:-h),p.t,p.i)}A(t)}const gt=new URLSearchParams(window.location.search).get("seed"),xt=gt?Number(gt):Date.now(),yt=(mt=61^(mt=xt)^mt>>>16,mt+=mt<<3,mt=Math.imul(mt,668265261),bt=(mt^=mt>>>15)>>>0,t=>(bt=bt+1831565813|0,(((t=(t=Math.imul(bt^bt>>>15,1|bt))+Math.imul(t^t>>>7,61|t)^t)^t>>>14)>>>0)/2**32));var bt,mt;const kt=()=>yt();let St;function Lt(t,n,e){if(!e.et)return;const o=_(),c=P(dt(_(),t,n),t.i,e._,e.tt,o),s=ht();N(t.i,e._,e.tt,s),c&&s.M<0&&(e.et=!1)}function At(t,n,e){if(e.et)return;const s=_(),r=P(dt(_(),t,n),t.i,e._,e.tt,s),a=ht();if(N(t.i,e._,e.tt,a),r&&a.M>0){h=t,f=n,l={t:e._,i:e._,o:_()},p={t:e.tt,i:e.tt,o:_()},c(j,h.t,h.i),u(F,j),i(R,F,f),o(C,R,h.t),P(C,h.i,l.t,p.t,D)&&(c(W,C,D),c(h.t,h.t,W),c(h.i,h.i,W));const r=1,d=1e7,w=1,M=0,v=0,g=_(),x=_();L(t.t,t.i,r,w,M,v,s,s,d,w,M,v,a.p,g,x),c(t.i,t.t,g)}var h,f,l,p}function Tt(t=_(0,0)){const e=z().C("vp");return{J:0,width:e.O/2,height:e.O/16,nt:{o:_(),t:n(_(),t),i:n(_(),t)}}}function Ht(t=_(),e=0,o=_()){const s=z().C("vp"),r={t:n(_(),t),i:n(_(),t),o:_(),width:s.O/32,height:s.O/32},a=i(_(),o,e);return c(r.i,r.t,a),r}function Pt(t){return{nt:{t:n(_(),t),i:n(_(),t),o:_()},ot:_(10,10)}}function Dt(t,n){return{_:t,tt:n,et:!1}}const Wt={ct:0,st:null,state:"boot",level:-1,it:null,rt:[],at:[function(){return{ut:Ht(_(),.1,_(1,1)),ht:Tt(),target:Pt(_(-10,-10)),ft:[Dt(_(50,50),_(-50,50)),Dt(_(-50,50),_(-50,-50)),Dt(_(-50,-50),_(50,-50)),Dt(_(50,-50),_(50,50))],lt:[]}},function(){return{ut:Ht(_(0,-10),.5,_(0,1)),ht:Tt(),target:Pt(_(30,10)),ft:[Dt(_(20,15),_(-20,15)),(t=_(-20,5),n=_(20,5),{_:t,tt:n,et:!0}),Dt(_(50,50),_(-50,50)),Dt(_(-50,50),_(-50,-50)),Dt(_(-50,-50),_(50,-50)),Dt(_(50,-50),_(50,50))],lt:[]};var t,n},function(){const t=Tt();return{ut:Ht(_(-30,-40),.5,_(0,1)),ht:t,target:Pt(_(30,-40)),ft:[Dt(_(50,50),_(-50,50)),Dt(_(-50,50),_(-50,-50)),Dt(_(-50,-50),_(50,-50)),Dt(_(50,-50),_(50,50))],lt:[(e=_(-20,10),o=_(1,-1),{nt:{t:n(_(),e),i:n(_(),e),o:_()},ot:_(10,10),dt:n(_(),o)})]};var e,o}]};function jt(t){const n=Wt;n.st=n.state,n.state=t,n.ct=0}function Ft(t){return t*O/1e3}function Rt(t){return t.toFixed(3)}const Ct={KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,ArrowLeft:!1,ArrowRight:!1,ShiftLeft:!1,ShiftRight:!1};function Et(){return Ct}function Kt(t,n,e,o){const c=z().C("vp"),s=c.$.target,{U:i}=c.$,a=[[_(s.x-i.x,s.y+i.y),_(s.x+i.x,s.y+i.y),ht()],[_(s.x+i.x,s.y+i.y),_(s.x+i.x,s.y-i.y),ht()],[_(s.x+i.x,s.y-i.y),_(s.x-i.x,s.y-i.y),ht()],[_(s.x-i.x,s.y-i.y),_(s.x-i.x,s.y+i.y),ht()]];for(let n=0;n<a.length;n++){const[e,o,c]=a[n];N(t,e,o,c)}const[[u,h,f],[l,p,d],[w,M,v],[g,x,y]]=a;let b,m,k;const S=it(o,56);if(f.M>0&&d.M>0)b=_(d.h.x,f.h.y),m=r(b,t),k="right";else if(d.M>0&&v.M>0)b=_(d.h.x,v.h.y+S.Z),m=r(b,t),k="right";else if(v.M>0&&y.M>0)b=_(y.h.x,v.h.y+S.Z),m=r(b,t),k="left";else if(y.M>0&&f.M>0)b=_(y.h.x,f.h.y),m=r(b,t),k="left";else if(f.M>0)b=_(Math.min(Math.max(f.h.x,u.x),h.x),f.h.y),m=f.l,k="center";else if(d.M>0)b=_(d.h.x,Math.max(Math.min(l.y,d.h.y),p.y)),m=d.l,k="right";else if(v.M>0)b=_(Math.max(Math.min(w.x,v.h.x),M.x),v.h.y+S.Z),m=v.l,k="center";else{if(!(y.M>0))return;b=_(y.h.x,Math.min(Math.max(g.y,y.h.y),x.y)),m=y.l,k="left"}if(m<.7*((n.x/2+n.y/2)/2))return;const L=c.I.N;L.save(),st(o,b,k,56,Y,V),L.restore()}Q(window,"keydown",t=>{Ct[t.code]=!0}),Q(window,"keyup",t=>{Ct[t.code]=!1});function Nt(t,n){return!!((t,n,o,c,s,i,r,a,u)=>{const h=s-t,f=r/2+o/2-Math.abs(h),l=i-n,p=a/2+c/2-Math.abs(l);if(f<=0)return null;if(p<=0)return null;if(e(u.resolve,0,0),e(u.wt,0,0),e(u.Mt,0,0),f<p){const n=h<0?-1:1;u.resolve.x=f*n,u.Mt.x=n,u.wt.x=t+o/2*n,u.wt.y=i}else{const t=l<0?-1:1;u.resolve.y=p*t,u.Mt.y=t,u.wt.x=s,u.wt.y=n+c/2*t}return u})(t.nt.t.x,t.nt.t.y,t.ot.x,t.ot.y,n.t.x,n.t.y,n.width,n.height,{resolve:_(),wt:_(),Mt:_()})}let Gt=0,It=[];const Ot=z(),$t=Ot.D([{L:"fps",vt:60}]),zt=t=>{ct(t.C("fps").vt.toFixed(2),_(100,0),"right",56,V)};function Ut(t){Ot.data($t,"fps").vt=t}function Zt(t){const n=z().C("vp"),e=n.I.N,{x:o,y:c}=t.nt.t,s=t.ot.x/2,i=t.ot.x/4,r=n.O/64,a=t.ot.y/r,u=s*Math.SQRT2,h=r*Math.SQRT2/2;e.save(),e.fillStyle=V,e.strokeStyle=V;const f=wt(t.dt);e.translate(nt(o,"x"),nt(c,"y")),e.rotate(f-Math.PI/2),qt(e,a,r,u,0,0-i+h,Math.PI/4),qt(e,a,r,u,0,0+i-h,-Math.PI/4),e.restore()}function qt(t,n,e,o,c,s,i){for(let r=0;r<n;r+=2){t.save(),t.translate(tt(s),tt(c+r*e)),t.rotate(i);(r<Math.floor(n/4)?t.strokeRect:t.fillRect).call(t,tt(0-o/2),tt(0),tt(o),tt(e)),t.restore()}}function Bt(t,o){const c=o.nt.t,s=(o.ot.y,o.ot.x/2),i=_(c.x,c.y+s),r=_(c.x,c.y-s),a=wt(o.dt);ut(i,i,c,a),ut(r,r,c,a);const u=_(),h=P(t.i,t.t,i,r,u),f=ht();N(t.i,i,r,f),h&&f.M<0&&(n(t.t,o.nt.t),n(t.i,t.t),e(t.o,5*o.dt.x,5*o.dt.y))}function Jt(){}!async function(){await async function(){}();const t=z();at();const e=[],s=[];e.push(t=>{ot()});const r=t.C("vp");e.push((function(t,n){switch(Wt.state){case"boot":break;case"level":{if(!Wt.it)break;const{target:t,ht:n,ut:e,ft:o,lt:s}=Wt.it;!function(){const t=z().C("vp"),{$:n}=t,e=2*n.U.x,o=2*n.U.y;if(!St){const n=document.createElement("canvas"),c=n.getContext("2d");St=U(tt(2*t.$.U.x),tt(2*t.$.U.y),n);const s=.1,i=.3,r=2*t.$.U.y*8;c.fillStyle=X;let a=0;for(;a<r;){const t=kt()*e,n=kt()*o,r=kt()*(i-s)+s;c.beginPath(),c.arc(tt(t),tt(n),tt(r),0,2*Math.PI,!1),c.fill(),a++}}const c=n.target.x/e,s=n.target.y/o,i=Math.floor(c),r=Math.floor(s);let a=n.target.x%e/e,u=n.target.y%o/o;a=n.target.x<0?1-Math.abs(a):a,u=n.target.y<0?1-Math.abs(u):u;const h=t.I.N;h.fillStyle=Y,h.fillRect(nt(n.target.x-n.U.x,"x"),nt(n.target.y+n.U.y,"y"),tt(2*n.U.x),tt(2*-n.U.y)),h.drawImage(St.K,0,0,tt(e),tt(o),nt(i*e,"x"),nt(r*o,"y"),tt(e),tt(o)),a<.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt((i-1)*e,"x"),nt(r*o,"y"),tt(e),tt(o)),a>=.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt((i+1)*e,"x"),nt(r*o,"y"),tt(e),tt(o)),u<.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt(i*e,"x"),nt((r-1)*o,"y"),tt(e),tt(o)),u>=.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt(i*e,"x"),nt((r+1)*o,"y"),tt(e),tt(o)),a<.5&&u<.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt((i-1)*e,"x"),nt((r-1)*o,"y"),tt(e),tt(o)),a>=.5&&u<.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt((i+1)*e,"x"),nt((r-1)*o,"y"),tt(e),tt(o)),a<.5&&u>=.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt((i-1)*e,"x"),nt((r+1)*o,"y"),tt(e),tt(o)),a>=.5&&u>=.5&&h.drawImage(St.K,0,0,tt(e),tt(o),nt((i+1)*e,"x"),nt((r+1)*o,"y"),tt(e),tt(o))}(),function(t,n){const e=z().C("vp").I.N,{x:o,y:c}=t.nt.t,s=t.ot.x/2,i=t.ot.y/2;e.save(),e.fillStyle=V,e.translate(nt(o,"x"),nt(c,"y")),e.fillRect(0-tt(s),0-tt(i),tt(t.ot.x),tt(t.ot.y)),e.restore()}(t),function(t){const n=z().C("vp"),e=n.I.N,{x:o,y:c,angle:s,X:i,V:r,Y:a,p1:u}=Mt(t,n);e.save(),e.fillStyle=V,e.translate(nt(o,"x"),nt(c,"y")),e.rotate(Math.PI/2+s),e.fillRect(0-tt(r),0-tt(i),tt(t.width),tt(t.height)),e.restore()}(n),function(t,n){const e=z().C("vp"),o=e.I.N,{t:s,i:r,width:h,height:f}=t,l=h/2,p=f/2,d=nt(r.x+1*(s.x-r.x),"x"),w=nt(r.y+1*(s.y-r.y),"y"),M=tt(h),v=tt(f);o.save();{const t=c(_(),s,r),n=u(t,t),a=i(n,n,10*e.O);o.lineWidth=tt(1),o.strokeStyle=X,o.setLineDash([tt(1),tt(3)]),o.beginPath(),o.moveTo(d,w),o.lineTo(d+tt(a.x),w+tt(a.y)),o.stroke(),o.setLineDash([])}{const t=l/8,n=c(_(),s,r),e=a(n)/t,h=u(n,n);o.fillStyle="rgba(255,255,132,0.1)";const f=_();for(let n=0;n<e;n++)i(f,h,n*t),o.fillRect(d-tt(f.x)-tt(l),w-tt(f.y)-tt(p),M,v)}o.fillStyle=V,o.fillRect(d-tt(l),w-tt(p),M,v),o.restore()}(e),function(t){for(let n=0;n<t.length;n++)Zt(t[n])}(s),function(t){const{I:{N:n}}=z().C("vp");n.save(),n.strokeStyle=V,n.lineWidth=tt(1);for(let e=0;e<t.length;e++){const o=t[e];o.et?n.setLineDash([tt(1),tt(2)]):n.setLineDash([]),n.beginPath(),n.moveTo(nt(o._.x,"x"),nt(o._.y,"y")),n.lineTo(nt(o.tt.x,"x"),nt(o.tt.y,"y")),n.closePath(),n.stroke()}n.restore()}(o),function(t,n){const e=z().C("vp");ct(Rt(Ft(t.ct)),_(e.O/2,0),"center",56,V),ct(`Level ${t.level+1} of ??`,_(0,0),"left",56,V),t.it&&(Kt(t.it.target.nt.t,t.it.target.ot,0,"TARGET"),Kt(t.it.ut.t,_(t.it.ut.width,t.it.ut.height),0,"SIGNAL"))}(Wt);break}case"win":{const n=t.C("vp");ct(`Mission\nCompleted!\n${Rt(Ft(Wt.rt[Wt.level]))}s`,_(n.O/2,-10),"center",15,V);break}case"nextlevel":break;case"thanks":ct(`The SIGNAL\nmade it,\nthanks to you!\nTotal:\n${Rt(Ft(Wt.rt.reduce((t,n)=>t+=n,0)))}s`,_(t.C("vp").O/2,-10),"center",15,V),console.log("thanks!");break}!function(t=Y){const n=z().C("vp"),{N:e}=n.I;e.fillStyle=t;const o=2*n.$.U.x,c=n.B-2*n.$.U.y;e.fillRect(nt(n.$.target.x-n.$.U.x,"x"),nt(n.$.target.y-n.$.U.y,"y"),tt(o),tt(-c))}()})),s.push((t,e)=>{switch(Wt.state){case"boot":return console.log("boot"),jt("nextlevel");case"level":{if(0===Wt.ct){const t=Wt.at[Wt.level];if(!t)return jt("thanks");Wt.it=t()}if(!Wt.it)break;const{target:t,ht:n,ut:e}=Wt.it,c=Et();c.ArrowLeft&&(n.J+=.1),c.ArrowRight&&function(t){t.J-=.1}(n);const s=c.ShiftLeft||c.ShiftRight?_(1,0):_(.2,0),i=_();let r=0;if(c.KeyW&&c.KeyD?r=Math.PI/4:c.KeyW&&c.KeyA?r=Math.PI*(3/4):c.KeyS&&c.KeyD?r=-Math.PI/4:c.KeyS&&c.KeyA?r=-Math.PI*(3/4):c.KeyW?r=Math.PI/2:c.KeyA?r=Math.PI:c.KeyS?r=-Math.PI/2:c.KeyD&&(r=0),(0!==r||c.KeyD)&&function(t,n){o(t.nt.o,t.nt.o,n)}(n,ut(_(),s,i,r)),Nt(t,e)){const t=Wt;return t.rt[t.level]=t.ct,jt("win")}break}case"win":0===Wt.ct&&(c=()=>jt("nextlevel"),s=1e3,It.push({id:++Gt,action:c,delay:s,gt:0}));break;case"nextlevel":{const t=Wt;return t.level+=1,t.it=null,jt("level")}}var c,s;if(!Wt.it)return;const{target:i,ht:a,ut:u,ft:f,lt:l}=Wt.it;i&&a&&u&&(((t,n)=>{const e=(t.i.x-t.t.x)*n,o=(t.i.y-t.t.y)*n;t.i.x=t.t.x+e,t.i.y=t.t.y+o})(a.nt,.8),h(a.nt,e),vt(u,a,r,e),function(t,n){for(let e=0;e<n.length;e++)Bt(t,n[e])}(u,l),function(t,n){for(let e=0;e<t.length;e++){const o=t[e];Lt(n,n.width/2,o),At(n,n.width/2,o)}}(f,u),A(a.nt),function(t){const e=z().C("vp");n(e.$.target,t)}(a.nt.t)),Wt.ct+=1}),e.push(zt);const{stop:f}=(({xt:t,yt:n,bt:e,update:o,kt:c=10,St:s=(()=>{}),Lt:i=(()=>{})})=>{const r=window.performance,a=t,u=n,h=r.now.bind(r),f=window.requestAnimationFrame.bind(window);let l=0,p=null,d=h(),w=h(),M=0,v=60;return function t(){const n=h();p=f(t),l+=n-d,d=n;let r=l-a>=0,g=Math.floor(l/u);if(g>=c)return l=0,d=h(),void s();for(;g-- >0;)l-=u,o(u);r&&e(l/a),M+=1,w+1e3<=n&&(v=.25*M+.75*v,M=0,w=n,i(v))}(),{stop:()=>{p&&cancelAnimationFrame(p)}}})({xt:16.6666666,yt:O,update:n=>{((t=1)=>{It.slice().forEach((n,e)=>{n.gt+=t,n.gt>=n.delay&&(It.splice(e,1),n.action(n.delay,n.gt))})})(n),s.forEach(e=>e(t,n)),t.F()},bt:n=>{e.forEach(e=>e(t,n))},St:Jt,Lt:Ut})}()}();